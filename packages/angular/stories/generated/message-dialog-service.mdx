import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Components/Message Dialog Service" />

# Components/Message Dialog Service

{/*
This file is automatically generated from message-dialog-service.stories.ts
Do not edit this file directly. Run 'yarn extract-templates' to regenerate.
To add custom introduction content, create message-dialog-service.intro.md */}

## Custom Component for Message Dialog

When using `showModal()` with a custom Angular component, you can create a component that receives data through dependency injection. Here's the `CustomMessageComponent` used in the examples:

```typescript
import { Component, Inject } from '@angular/core';
import { CommonModule } from '@angular/common';

@Component({
  standalone: true,
  imports: [CommonModule],
  template: `
    <div style="padding: 1rem;">
      <h3 style="margin-top: 0;">Custom Message Content</h3>
      <p>You can <em>customize</em> the message with <strong>HTML</strong>!</p>
      <p>Message data: {{ data }}</p>
    </div>
  `
})
export class CustomMessageComponent {
  constructor(@Inject('MESSAGE_DIALOG_DATA') public data: string) {}
}
```

**Key Points:**
- Use `@Inject('MESSAGE_DIALOG_DATA')` to receive data passed via the `data` property in `showModal()`
- The component is rendered inside the message dialog's content area

**Usage Example:**
```typescript
const dialogRef = this.messageDialogService.showModal<CustomMessageComponent, string>({
  component: CustomMessageComponent,
  data: 'Your data here',
  title: 'Dialog Title',
  buttons: [
    { text: 'Cancel', value: 'cancel' },
    { text: 'OK', variant: 'primary', value: 'ok' }
  ]
});

dialogRef.afterClosed().subscribe(result => {
  console.log('Dialog closed with:', result);
});
```

## Message Dialog Service Example

<p>The <strong>MessageDialogService</strong> provides a comprehensive API for displaying message dialogs in Angular applications.</p>


```typescript
import { MessageDialogService } from '@sl-design-system/angular';
import { ButtonComponent } from '@sl-design-system/angular/button';
import { MessageDialog as MessageDialogElement } from '@sl-design-system/message-dialog';

@Component({
  selector: 'sla-message-dialog-service',
  template: `<style>
    .container {
      display: flex;
      gap: 0.8rem;
      flex-wrap: wrap;
      flex-direction: column;
      max-width: 700px;
    }
  </style>
  <h3>Message Dialog Service examples</h3>
  <div class="container">
    <div>
      <h4>Static methods (recommended for simple cases)</h4>
      <p>These methods use the MessageDialog static API and work well for simple alerts and confirmations:</p>
      <div style="display: flex; gap: 0.8rem; flex-wrap: wrap;">
        <sl-button (click)="showAlert()" variant="primary">Show Alert</sl-button>
        <sl-button (click)="showAlertNonCancellable()" variant="primary" fill="outline"
          >Alert (Non-cancellable)</sl-button
        >
        <sl-button (click)="showConfirm()" variant="secondary">Show Confirm</sl-button>
        <sl-button (click)="showCustomButtons()" variant="info">Custom Buttons</sl-button>
      </div>
    </div>

    <div>
      <h4>With Custom Angular Component</h4>
      <p>
        Use <code>showModal()</code> to render a custom Angular component as the message content. This is useful for
        complex dialogs with forms or interactive content:
      </p>
      <div style="display: flex; gap: 0.8rem; flex-wrap: wrap;">
        <sl-button (click)="showWithComponent()" variant="primary">Show with Component</sl-button>
        <sl-button (click)="showCriticalAction()" variant="danger">Critical Action</sl-button>
      </div>
    </div>
  </div>`,
  imports: [ButtonComponent, CommonModule]
})
export class MessageDialogServiceExampleComponent {

  lastResult: string | undefined;

  constructor(private messageDialogService: MessageDialogService) {}

  async showAlert(): Promise<void> {
    await this.messageDialogService.alert(
      'This is an alert message. Use this to alert the user about something. This is the design system equivalent of calling window.alert().',
      'Alert'
    );
    this.lastResult = 'Alert closed';
    console.log('Alert was closed');
  }

  async showAlertNonCancellable(): Promise<void> {
    await this.messageDialogService.show({
      title: 'Important Notice',
      message: 'This is a critical alert that cannot be cancelled. You must acknowledge it by clicking OK.',
      buttons: [{ text: 'OK', variant: 'primary', autofocus: true }],
      disableCancel: true
    });
    this.lastResult = 'Non-cancellable alert closed';
    console.log('Non-cancellable alert was closed');
  }

  async showConfirm(): Promise<void> {
    const result = await this.messageDialogService.confirm(
      'This is a confirmation message. The message dialog contains a "Cancel" and "OK" button by default. You can customize this using the buttons property.',
      'Confirm'
    );

    if (result !== undefined) {
      await this.messageDialogService.alert(`The result was: ${result}`);
    }

    this.lastResult = `Confirm: ${result === true ? 'OK' : result === false ? 'Cancel' : 'Closed'}`;

    console.log('Confirmation result:', result);
  }

  async showCustomButtons(): Promise<void> {
    const result = await this.messageDialogService.show({
      title: 'Custom buttons',
      message: 'This is a message with custom buttons. Are you sure you want to press any buttons?',
      buttons: [
        { text: 'No, run away!', fill: 'outline', value: 'NO', variant: 'primary' },
        { text: "Yes, I don't care what it does", value: 'YES', variant: 'danger' }
      ],
      disableCancel: true
    });
    this.lastResult = `Custom: ${result ?? 'Cancelled'}`;
    console.log('User selected:', result);
  }

  showWithComponent(): void {
    const dialogRef = this.messageDialogService.showModal<CustomMessageComponent, string>({
      component: CustomMessageComponent,
      data: 'This is some data passed to the component!',
      title: 'Custom Component Message',
      buttons: [
        { text: 'Cancel', fill: 'ghost', value: 'cancel' },
        { text: 'OK', variant: 'primary', autofocus: true, value: 'ok' }
      ]
    });

    dialogRef.afterClosed().subscribe(result => {
      this.lastResult = `Component dialog: ${result ?? 'Cancelled'}`;
      console.log('Component dialog closed with result:', result);
    });
  }

  showCriticalAction(): void {
    const dialogRef = this.messageDialogService.showModal<CustomMessageComponent, string>({
      component: CustomMessageComponent,
      data: 'You are about to perform a critical action that requires confirmation.',
      title: 'Critical Action Required',
      buttons: [{ text: 'I Understand, Proceed', variant: 'danger', autofocus: true, value: 'proceed' }],
      disableCancel: true
    });

    dialogRef.afterClosed().subscribe(result => {
      this.lastResult = `Critical action: ${result ?? 'Should not happen'}`;
      console.log('Critical action dialog closed with result:', result);
    });
  }

}
```

## Advanced Example

<p>Advanced examples demonstrating powerful features of the MessageDialogService:</p>


```typescript
import { MessageDialogService } from '@sl-design-system/angular';
import { ButtonComponent } from '@sl-design-system/angular/button';
import { MessageDialog as MessageDialogElement } from '@sl-design-system/message-dialog';

@Component({
  selector: 'sla-message-dialog-advanced',
  template: `<h3>Advanced Message Dialog Service examples</h3>
  <p>Demonstrates programmatic control, multiple dialogs, and complex scenarios.</p>
  <div style="display: flex; gap: 0.8rem; flex-wrap: wrap; flex-direction: column; max-width: 700px;">
    <div>
      <h4>Multiple Dialogs</h4>
      <p>Open and manage multiple dialogs simultaneously:</p>
      <div style="display: flex; gap: 0.8rem; flex-wrap: wrap;">
        <sl-button (click)="openMultipleDialogs()" variant="primary">Open Multiple Dialogs</sl-button>
        <sl-button (click)="closeAll()" variant="danger">Close All Dialogs</sl-button>
      </div>
    </div>

    <div>
      <h4>Sequential Dialogs</h4>
      <p>Show dialogs one after another based on user actions:</p>
      <div style="display: flex; gap: 0.8rem; flex-wrap: wrap;">
        <sl-button (click)="showSequentialDialogs()" variant="info">Start Wizard</sl-button>
      </div>
    </div>

    <div>
      <h4>Programmatic Control</h4>
      <p>Control dialogs programmatically with timeouts or conditions:</p>
      <div style="display: flex; gap: 0.8rem; flex-wrap: wrap;">
        <sl-button (click)="showAutoClosingDialog()" variant="warning">Auto-closing Dialog</sl-button>
      </div>
    </div>

    <div style="margin-top: 1rem; padding: 1rem; background: var(--sl-color-container-tertiary); border-radius: 4px;">
      <strong>Status:</strong> {{ status }}
    </div>
  </div>`,
  imports: [ButtonComponent, CommonModule]
})
export class MessageDialogAdvancedExampleComponent {

  status = 'Ready';

  constructor(private messageDialogService: MessageDialogService) {}

  openMultipleDialogs(): void {
    this.status = 'Opening multiple dialogs...';

    // Open first dialog
    const dialog1 = this.messageDialogService.showModal({
      title: 'First Dialog',
      message: 'This is the first dialog. You can open multiple dialogs at once.',
      buttons: [{ text: 'OK', variant: 'primary', value: 'ok1' }]
    });

    dialog1.afterClosed().subscribe(result => {
      console.log('First dialog result:', result);
      this.status = `First dialog closed with: ${result}`;
    });

    // Open second dialog after a short delay
    setTimeout(() => {
      const dialog2 = this.messageDialogService.showModal({
        title: 'Second Dialog',
        message: 'This is the second dialog. Both dialogs are open simultaneously.',
        buttons: [{ text: 'OK', variant: 'info', value: 'ok2' }]
      });

      dialog2.afterClosed().subscribe(result => {
        console.log('Second dialog result:', result);
        this.status = `Second dialog closed with: ${result}`;
      });
    }, 500);
  }

  closeAll(): void {
    this.messageDialogService.closeAll();
    this.status = 'All dialogs closed programmatically';
    console.log('All dialogs closed');
  }

  async showSequentialDialogs(): Promise<void> {
    this.status = 'Starting wizard...';

    // Step 1
    const step1 = await this.messageDialogService.show({
      title: 'Step 1: Welcome',
      message: 'Welcome to the setup wizard. Click Next to continue.',
      buttons: [
        { text: 'Cancel', value: 'cancel', fill: 'ghost' },
        { text: 'Next', value: 'next', variant: 'primary', autofocus: true }
      ]
    });

    if (step1 !== 'next') {
      this.status = 'Wizard cancelled at Step 1';
      return;
    }

    // Step 2
    const step2 = await this.messageDialogService.show({
      title: 'Step 2: Configuration',
      message: 'Please confirm your configuration settings.',
      buttons: [
        { text: 'Back', value: 'back', fill: 'ghost' },
        { text: 'Next', value: 'next', variant: 'primary', autofocus: true }
      ]
    });

    if (step2 !== 'next') {
      this.status = 'Wizard cancelled at Step 2';
      return;
    }

    // Step 3 - Final confirmation
    await this.messageDialogService.show({
      title: 'Step 3: Confirmation',
      message: 'Setup complete! Your changes have been saved.',
      buttons: [{ text: 'Finish', value: 'finish', variant: 'success', autofocus: true }],
      disableCancel: true
    });

    this.status = 'Wizard completed successfully!';
  }

  showAutoClosingDialog(): void {
    this.status = 'Opening auto-closing dialog...';

    const dialogRef = this.messageDialogService.showModal({
      title: 'Auto-closing Dialog',
      message: 'This dialog will automatically close in 5 seconds unless you click OK first.',
      buttons: [{ text: 'OK', variant: 'primary', value: 'ok' }]
    });

    // Auto-close after 5 seconds
    const timeout = setTimeout(() => {
      dialogRef.close('timeout');
      this.status = 'Dialog auto-closed after timeout';
    }, 5000);

    dialogRef.afterClosed().subscribe(result => {
      clearTimeout(timeout);
      if (result === 'timeout') {
        console.log('Dialog was auto-closed');
      } else {
        this.status = `Dialog closed by user: ${result}`;
        console.log('Dialog closed by user:', result);
      }
    });
  }

}
```

## Mobile

<p>Example of a message dialog optimized for mobile devices. The dialog adapts to smaller screens while maintaining usability.</p>

## Custom Message

<p>Example showing how to use HTML content in message dialogs using the static <code>MessageDialog.show()</code> method with Lit HTML.</p>

