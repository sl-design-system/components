:host {
  --_background: var(--sl-color-accordion-default-header);
  --_background-hover: var(--sl-color-accordion-hover-header);
  --_background-active: var(--sl-color-accordion-active-header);
  --_border-color: var(--sl-color-accordion-default-border);
  --_border-width: var(--sl-border-width-divider);
  --_focus-outline: var(--sl-color-focusring-default) solid var(--sl-border-width-focusring-default);
  --_focus-outline-offset: var(--sl-border-width-focusring-offset);
  --_icon-size: var(--sl-size-accordion-icon-height);
  --_padding-block: var(--sl-space-accordion-content-block);
  --_panel-color: var(--sl-color-accordion-default-foreground);
  --_panel-font: var(--sl-text-accordion-body);
  --_panel-padding-block: var(--sl-space-accordion-content-block);
  --_panel-padding-inline: var(--sl-space-accordion-content-inline);
  --_title-color: var(--sl-color-accordion-default-foreground);
  --_title-color-active: var(--sl-color-accordion-active-foreground);
  --_title-color-disabled: var(--sl-color-accordion-disabled-foreground);
  --_title-color-hover: var(--sl-color-accordion-hover-foreground);
  --_title-font: var(--sl-text-accordion-title);
  --_title-gap: var(--sl-space-accordion-title-gap);
  --_title-padding: var(--sl-space-accordion-title-inline);
}

:host {
  display: flex;
  list-style: none;
}

:host([disabled]) summary {
  color: var(--_title-color-disabled);
  cursor: default;

  rect {
    fill: var(--_title-color-disabled);
  }
}

details {
  border-bottom: var(--_border-width) solid var(--_border-color); //1px solid #c6c6c6; // TODO: change to box-shadow because of focus visible border radius???
  flex: 1;
}

details > summary:first-of-type {
  list-style: none;
}

details > summary:first-of-type::-webkit-details-marker {
  display: none; /* Hides the arrow in Safari */
}

//// On click
//// Change to: "02";
//// Animate: Smart animate;
//animation-timing-function: cubic-bezier(0.7, -0.4, 0.4, 1.4);
//animation-duration: 300ms;

//transition: all 300ms cubic-bezier(0.7, -0.4, 0.4, 1.4);

// On click
// Change to: "minus";
// Animate: Smart animate;
//animation-timing-function: cubic-bezier(0.6, 2, 0.6, 1);
//animation-duration: 300ms;

//transition: all 300ms cubic-bezier(0.6, 2, 0.6, 1);

summary {
  background-color: var(--_background);
  color: var(--_title-color);
  //border-bottom: 1px solid #c6c6c6; // TODO: change to box-shadow because of focus visible border radius???
  cursor: pointer;
  display: flex;
  font: var(--_title-font);
  gap: var(--_title-gap); //8px;
  padding-block: var(--_padding-block);
  padding-inline: var(--_title-padding);
  transition: background 300ms;
  //transition: background 300ms, transform 400ms;
  //transition: transform 400ms;
  z-index: 1; // TODO: maybe remove and in other place z-index 1 instead of 2?

  // svg animation stylings
  .horizontal-line {
    transform: rotate(90deg);
  }

  rect {
    fill: var(--_title-color);
    transform-origin: center;
    transition: transform 300ms cubic-bezier(0.6, 2, 0.6, 1);
  }
}

:host(:not([disabled])) summary:hover {
  background-color: var(--_background-hover);
  color: var(--_title-color-hover);

  rect {
    fill: var(--_title-color-hover);
  }
}

:host(:not([disabled])) summary:active {
  background-color: var(--_background-active);
  color: var(--_title-color-active);

  rect {
    fill: var(--_title-color-active);
  }
}

:host(:not([disabled])) summary:focus-visible {
  border-radius: 4px; // TODO: change this one in the future
  outline: var(--_focus-outline);
  outline-offset: var(--_focus-outline-offset);
  position: relative;
  /** z-index is set to 2 to make sure the outline is above the summary, when that is focused or hovered */
  z-index: 2;
}

.panel {
  color: var(--_panel-color);
  font: var(--_panel-font);
  min-height: 0;
  //transition: transform 300ms ease-in-out, opacity 300ms ease-in-out;
  padding: var(--_panel-padding-block) var(--_panel-padding-inline); //16px;
  //margin: 0 40px 16px;
  //padding-top: 20px;
  //margin: 0 var(--_panel-padding-inline) var(--_panel-padding-block);
  //padding-top: var(--_panel-padding-block);
  //border-top: 1px solid #c6c6c6;
  position: relative;
  transform-origin: top;
  /* stylelint-disable-next-line property-no-vendor-prefix */
  //-webkit-transition: transform 300ms cubic-bezier(0.7, -0.4, 0.4, 1.4);
  transition: transform 300ms cubic-bezier(0.7, -0.4, 0.4, 1.4);
  //animation: append-animate-panel 300ms cubic-bezier(0.7, -0.4, 0.4, 1.4) reverse;
}

details {
  .panel {
    opacity: 0;
    //padding: 16px;
    //transform: scaleY(0);
    //transition: transform 300ms ease;
  }
}

//@keyframes flipdown {
//  0% {
//    opacity: 0;
//    transform-origin: top center;
//    transform: rotateX(-90deg);
//  }
//  5% {
//    opacity: 1;
//  }
//  80% {
//    transform: rotateX(8deg);
//  }
//  83% {
//    transform: rotateX(6deg);
//  }
//  92% {
//    transform: rotateX(-3deg);
//  }
//  100% {
//    transform-origin: top center;
//    transform: rotateX(0deg);
//  }
//}

//@keyframes slideDown {
//  0% {
//    opacity: 0.5;
//    transform: translateY(-10px);
//  }
//
//  50% {
//    opacity: 0.8;
//    transform: translateY(-5px);
//  }
//
//  100% {
//    opacity: 1;
//    transform: translateY(0);
//  }
//}

details[open] {
  summary::after {
    background-color: var(--_border-color);
    bottom: 0; /* Place it at the bottom */
    content: ''; /* Create an empty pseudo-element */
    height: var(--_border-width);
    left: 0; /* Align it to the left edge */
    margin-inline: var(--_panel-padding-inline);
    position: absolute; /* Position it absolutely within the parent */
    width: calc(100% - 2 * var(--_panel-padding-inline)); /* Make it span the entire width of the parent */
  }

  .panel {
    //transform: scaleY(1);
    animation-duration: 300ms;
    animation-name: animate-panel; //append-animate-panel;
    animation-timing-function: cubic-bezier(0.7, -0.4, 0.4, 1.4);
    //transform: scaleY(1);
    // transition: all 300ms cubic-bezier(0.7, -0.4, 0.4, 1.4);
    //animation: append-animate-panel 300ms cubic-bezier(0.7, -0.4, 0.4, 1.4); // linear
    opacity: 1;
  }
}

.opened {
  .vertical-line {
    transform: rotate(90deg);
  }

  .horizontal-line {
    transform: rotate(270deg);
  }
}

details[open] summary {
  sl-icon:not(.opened) {
    // sl-icon.opened
    transform: rotate(90deg);
  }
}

//details[open] > .panel {
//  opacity: 0;
//  transition: opacity 0.3s ease-in-out; /* Add a smooth transition */
//}
//
///* When details is open, show the content */
//details[open] > .panel {
//  opacity: 1;
//}

//.icons {
//  display: inline-flex;
//  inline-size: auto;
// // margin-right: 16px;
//  //display: block;
//  position: relative;
//
//  //svg {
//  //  //padding: 6px 4px; // TODO: no tokens for icon padding?
//  //  //width: 16px; //var(--_icon-size); // TODO: there is no token?
//  //  //height: var(--_icon-size);
//  //  //height: 16px;
//  //}
//}

//@keyframes append-animate {
//  from {
//    opacity: 0;
//    transform: scaleY(0);
//  }
//
//  to {
//    opacity: 1;
//    transform: scaleY(1);
//  }
//}

//details[open] > .panel {
//  animation: append-animate 0.3s linear;
//  transform-origin: 50% 0;
//}
//
//.plus {
//  opacity: 1;
//}
//
//.minus {
//  opacity: 0;
//}

//@keyframes append-animate {
//  from {
//    opacity: 0.8;
//    //transform: scaleY(0);
//    transform: rotate(-60deg);
//  }
//
//  to {
//    opacity: 1;
//    //transform: scaleY(1);
//    transform: rotate(0deg);
//  }
//}

@keyframes append-animate-panel {
  from {
    opacity: 0.8;
    transform: scaleY(0);
    //transform: rotate(-60deg);
  }

  to {
    opacity: 1;
    transform: scaleY(1);
    //transform: rotate(0deg);
  }
}

//.minus:not(.opened) {
//  transform: rotate(90deg);
//}
//
//.minus.opened {
//  animation: append-animate 100ms linear;
//  //transform-origin: 50% 0;
//  opacity: 1;
//  //transform: rotate(90deg);
//}
//
//details[open] {
//  .plus {
//    opacity: 0;
//    transform: rotate(90deg);
//  }
//}

details > .wrapper {
  //overflow: hidden;
  //display: grid;
  /* intentionally independent from .animation as Safari 16
  would otherwise ignore the expansion animation. */
  animation-duration: 0.2s;
  display: block;
  height: auto;
  overflow: visible;
}

.animation {
  //background-color: #0074d9;
  animation-duration: 300ms;
  animation-name: animate-panel; //append-animate-panel;
  animation-timing-function: cubic-bezier(0.7, -0.4, 0.4, 1.4); //ease-out;
  //animation-fill-mode: both;
}

.collapsing {
  animation-direction: reverse;
  animation-duration: 300ms;
  animation-name: animate-panel; // append-animate-panel;
  animation-timing-function: cubic-bezier(0.7, -0.4, 0.4, 1.4); //ease-in;
}

@keyframes animate-panel {
  from {
    height: 0;
    opacity: 0;
  }

  to {
    height: 100px; //auto; //100%; //200px;
    opacity: 1;
  }
}
