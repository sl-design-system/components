$sizes: sm, md, lg, xl, 2xl, 3xl;
$shapes: circle, square;
$statuses: danger, success, warning, accent, neutral, primary;

:host {
  --_background: var(--sl-color-avatar-background);
  --_foreground: var(--sl-color-avatar-foreground);
  --_badge-background: var(--sl-color-badge-danger-background);
  --_badge-color: var(--sl-color-badge-danger-foreground);
  --_focusring-color: transparent;
  --_link-color: var(--sl-color-href-idle-foreground);
  --_link-color-active: var(--sl-color-href-active-foreground);
  --_link-color-hover: var(--sl-color-href-hover-foreground);
  --_link-decoration: underline;
  --_link-padding-block: calc(var(--sl-space-breadcrumb-gap-full) / 2);
  --_link-padding-inline: calc(var(--sl-space-breadcrumb-gap-full) / 2);
  --_link-underline-offset: 2px;
  --_max-inline-size: var(--sl-avatar-max-inline-size, 20rem);

  align-items: center;
  display: inline-flex;
  gap: var(--_gap);
  max-inline-size: 100%;
}

:host(:focus-visible) {
  --_focusring-color: var(--sl-color-focusring-default);
}

@each $size in $sizes {
  :host([size='#{$size}']) {
    --_badge-font: var(--sl-text-badge-text-#{$size});
    --_gap: var(--sl-space-avatar-block-#{$size}) var(--sl-space-avatar-inline-#{$size});
    --_header-font: var(--sl-text-avatar-header-#{$size});
    --_initials-font: var(--sl-text-avatar-initials-#{$size});
    --_subheader-font: var(--sl-text-avatar-subheader-#{$size});
  }

  :host([size='#{$size}'][href]) {
    --_gap: var(--sl-space-avatar-block-#{$size})
      calc(var(--sl-space-avatar-inline-#{$size}) - var(--_link-padding-inline));
  }
}

@each $shape in $shapes {
  :host([shape='#{$shape}']) {
    --_border-radius: var(--sl-border-radius-avatar-#{$shape});
  }
}

@each $status in $statuses {
  :host([status='#{$status}']) {
    --_badge-background: var(--sl-color-badge-#{$status}-background);
    --_badge-color: var(--sl-color-badge-#{$status}-foreground);
  }
}

picture {
  block-size: var(--_picture-size);
  display: grid;
  flex: 0 0 var(--_picture-size);
  inline-size: var(--_picture-size);
  place-content: center;
  position: relative;

  svg {
    margin: var(--_margin-top) var(--_margin-right) var(--_margin-bottom) var(--_margin-left);
    pointer-events: none;
  }

  text {
    text-anchor: middle;
    text-transform: uppercase;
  }

  .badge-text {
    font: var(--_badge-font);
  }

  .initials {
    font: var(--_initials-font);
  }
}

div {
  display: flex;
  flex: 1 1 auto;
  flex-direction: column;
  font: var(--_subheader-font);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;

  slot,
  [part='name'] {
    display: block;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  [part='name'] {
    font: var(--_header-font);
  }

  a {
    color: var(--_link-color);
    padding: var(--_link-padding-block) var(--_link-padding-inline);
    text-decoration: var(--_link-decoration);
    text-underline-offset: var(--_link-underline-offset, auto);

    &:hover {
      color: var(--_link-color-hover);
    }

    &:active {
      color: var(--_link-color-active);
    }
  }
}

:host([vertical]) {
  flex-direction: column;
  max-inline-size: var(--_max-inline-size);
  text-align: center;

  [part='name'] {
    max-inline-size: var(--_max-inline-size);
    overflow: hidden;
    white-space: initial;
    word-break: break-word;
  }

  slot {
    display: block;
    max-inline-size: var(--_max-inline-size);
    overflow: hidden;
    text-overflow: ellipsis;
  }
}
